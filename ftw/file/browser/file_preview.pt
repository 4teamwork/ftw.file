<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
      xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      xmlns:i18n="http://xml.zope.org/namespaces/i18n"
      lang="en"
      i18n:domain="ftw.file"
      tal:define="resource string:${here/portal_url}/++resource++ftw.file">

    <head>
        <title>File metadata</title>
        <link rel="stylesheet" type="text/css" media="screen"
              href="https://fast.fonts.net/cssapi/05ba7042-9884-4870-9fe8-095c4f2e9cc6.css" />
        <link rel="stylesheet" type="text/css" media="screen"
              href="++resource++ftw.file-preview.css"/>
    </head>

    <body>

        <div class="sidebar">
            <div class="file-details"
                 tal:define="file_info view/get_file_info;
                             pdf_info view/get_pdf_info">

                <div class="filename" tal:content="here/Title" />

                <div class="filedata discreet">
                    <span tal:content="file_info/mimetype_title" />
                    &mdash;
                    <span tal:content="file_info/filesize" />
                </div>

                <div class="discreet"
                     i18n:translate="file_metadata_dates">
                    Modified
                    <span tal:replace="python:here.toLocalizedTime(context.modified())"
                          i18n:name="file_metadata_modified" />,
                    created
                    <span tal:replace="python:here.toLocalizedTime(context.created())"
                          i18n:name="file_metadata_created" />
                </div>

                <a tal:attributes="href file_info/file_url"
                   target="_top"
                   class="original-file-link">
                    <img tal:attributes="src file_info/mimetype_icon_url;
                                         title file_info/mimetype_title;
                                         alt file_info/mimetype_title"
                         border="0"
                         class="mimetype_icon" />
                    <span i18n:translate="file_metadata_download_original">Download Original</span>
                </a>

                <a tal:condition="pdf_info"
                   tal:attributes="href pdf_info/pdf_url"
                   target="_top"
                   class="pdf-file-link">
                    <img tal:attributes="src pdf_info/mimetype_icon_url;
                                         title pdf_info/mimetype_title;
                                         alt pdf_info/mimetype_title"
                         border="0"
                         class="mimetype_icon" />
                    <span i18n:translate="file_metadata_open_pdf">Open PDF</span>
                </a>

                <a tal:attributes="href string:${context/absolute_url}/view"
                   target="_top"
                   class="document-details-link">
                    <span i18n:translate="file_metadata_document_details">Document details</span>
                </a>
            </div>

            <div class="journal">
                <b i18n:translate="file_metadata_journal_heading">Journal</b>

                <div class="journal-item" tal:repeat="item view/get_journal">
                    <div class="journal-item-actor">
                        <tal:ACTOR tal:define="actor item/actor" tal:condition="actor">
                            <img tal:attributes="src string:${actor/portrait_url}?size=30;
                                                 title actor/fullname"
                                 border="0" />
                        </tal:ACTOR>
                    </div>

                    <a class="journal-item-download"
                       tal:condition="item/downloadable_version"
                       tal:attributes="href string:${context/absolute_url}/file_download_version?version_id=${item/version_id}">
                        <img tal:attributes="src string:${resource}/download.png"
                             title="Download this version"
                             i18n:attributes="title file_metadata_download_version"
                             border="0" />
                    </a>

                    <div tal:content="item/relative_time"
                         tal:attributes="title python:here.toLocalizedTime(item['time'], long_format=True)"
                         class="journal-item-time discreet" />

                    <div tal:content="item/action"
                         i18n:translate=""
                         i18n:domain="plone"
                         class="journal-item-action" />

                    <div tal:content="item/comment"
                         class="journal-item-comment discreet" />

                    <span class="clearfix"><!-- --></span>
                </div>
            </div>
        </div>

        <div class="preview">
            <iframe tal:attributes="src view/get_preview_pdf_url" />
        </div>

    </body>
</html>
